---
title: 'ê°„ë‹¨í•œ ì‹¤ìŠµê³¼ í•¨ê»˜ React Query(Tanstack Query) ê³µë¶€í•˜ê¸° âœğŸ»'
date: 2023-04-26
tags: ['React']
thumbnail: /thumbnails/react.png
---

# React Query(Tanstack Query)

- Tanstack Query ê³µì‹ë¬¸ì„œ

ğŸ•¶ ì„œë²„ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
ì„œë²„ ìƒíƒœë€,

- ì•±ì´ ì†Œìœ í•˜ê±°ë‚˜ ì œì–´í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë ¤ë©´ ë¹„ë™ê¸° APIê°€ í•„ìš”í•˜ë‹¤.
- ì•±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ëŠ” ìœ íš¨ê¸°ê°„ì´ ì§€ë‚œ ìƒíƒœê°€ ë  ìˆ˜ ìˆë‹¤.

ì‡¼í•‘ëª° ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„  ì–´ë–¤ ê²ƒë“¤ì´ ì„œë²„ìƒíƒœì¼ê¹Œìš”?ì˜ˆë¥¼ ë“¤ë©´, ì‡¼í•‘ë¬¼ì˜ ìƒí’ˆ ëª©ë¡, ê²Œì‹œíŒ ëŒ“ê¸€, ì£¼ë¬¸ ì§„í–‰ ìƒí™©ê³¼ ê°™ì€ ê²ƒë“¤ì´ ìˆìŠµë‹ˆë‹¤.

ì´ëŸ¬í•œ íŠ¹ì„±ì„ ê°€ì§„ ì„œë²„ ìƒíƒœëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ë“¤ì´ í•„ìš”í•©ë‹ˆë‹¤.

- ìºì‹±
- ë°ì´í„° ì¤‘ë³µ í˜¸ì¶œì„ ì œê±°
- ë°ì´í„°ì˜ ë§Œë£Œ ì‹œì ì„ íŒŒì•…
- ë§Œë£Œë˜ì—ˆë‹¤ë©´ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸

_ğŸ‘‰ğŸ» ì¦‰, React QueryëŠ” ì„œë²„ ìƒíƒœë¥¼ ë³´ë‹¤ ì‰½ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ë©°, í´ë¼ì´ì–¸íŠ¸ ìƒíƒœì™€ ì„œë²„ ìƒíƒœë¥¼ ëª…í™•íˆ êµ¬ë¶„í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤._

ê²°ë¡ ì ìœ¼ë¡œ ë§í•˜ë©´ React Queryë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´,
![useState](/images/content/learning-react-query-with-practice/1.png)

ì´ ë§Œí¼ì˜ ì½”ë“œë¥¼

![useState](/images/content/learning-react-query-with-practice/2.png)

ì´ë ‡ê²Œ ê°„ê²°í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤ :)

## React Query ì‚¬ìš©ë°©ë²•

ê°„ë‹¨í•œ ì˜ˆì œë¥¼ í†µí•´ React Queryë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.
ë°ì´í„°ê°€ ë‹¤ ë°›ì•„ì™€ì§€ê¸° ì „ê¹Œì§€ëŠ” Loadingâ€¦ í‘œì‹œë¥¼ í•´ì¤¬ë‹¤ê°€ ë°ì´í„°ê°€ ë“¤ì–´ì˜¤ë©´ ì½”ì¸ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³´ì—¬ì£¼ë ¤ê³  í•©ë‹ˆë‹¤.
ì—¬ê¸° ì½”ì¸ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìˆëŠ” APIê°€ ìˆìŠµë‹ˆë‹¤.

```text
'https://api.coinpaprika.com/v1/coins'
```

### React Queryë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  êµ¬í˜„í•˜ëŠ” ë°©ë²•

ì²˜ìŒ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹œì‘ë  ë•Œ í•œ ë²ˆë§Œ ë°›ì•„ì˜¤ê³  ì‹¶ìœ¼ë‹ˆ useEffectë¥¼ ì•ˆì— fetch í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
ë¹„ë™ê¸° ë°ì´í„°ì˜ ìˆœì„œë¥¼ ë³´ì¥í•˜ë ¤ë©´ async, awaitë¥¼ ì‚¬ìš©í•´ì•¼í•˜ëŠ”ë° ë§ì´ì£ ..ë°©ë²•ì€ ë‘ ê°€ì§€ ì…ë‹ˆë‹¤.

- useEffect í•¨ìˆ˜ ë‚´ì—ì„œ ìƒˆë¡œìš´ í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê³  ì‹¤í–‰ì‹œí‚¨ë‹¤.
- ì¦‰ì‹œì‹¤í–‰í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.

ì €ëŠ” ì¦‰ì‹œì‹¤í–‰í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```jsx
useEffect(() => {
  (async () => {
    const resposnse = await fetch('https://api.coinpaprika.com/v1/coins');
    const json = await resposnse.json();
  })();
}, []);
```

ê·¸ë¦¬ê³  ì½”ì¸ ë°ì´í„°ë¥¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´ ìƒíƒœë¡œ ê´€ë¦¬í•´ì•¼í•˜ë¯€ë¡œ useStateë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
ì¶”ê°€ë¡œ ë˜ í•˜ë‚˜ì˜ ìƒíƒœê°€ í•„ìš”í•©ë‹ˆë‹¤. ë¡œë”© ì¤‘ì¸ì§€ ì•„ë‹Œì§€ì— ëŒ€í•œ ìƒíƒœì…ë‹ˆë‹¤. ì´ê²ƒ ë˜í•œ useStateë¥¼ ì‚¬ìš©í•´ì„œ ê´€ë¦¬í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```jsx
import { useState } from 'react';
export default function Coins() {
  const [coins, setCoins] = useState([]);
  const [loading, setLoading] = useState(true);
  useEffect(() => {
    (async () => {
      const resposnse = await fetch('https://api.coinpaprika.com/v1/coins');
      const json = await resposnse.json();
      setCoins(json);
      setLoading(false);
    })();
  }, []);
  return (
    <>
      {' '}
      <h1>Coins</h1> {loading ? (
        <h1>Loading...</h1>
      ) : (
        <ul>
          {' '}
          {coins.map((coin) => (
            <li key={coin.id}>
              {' '}
              <Link to={`/${coin.id}`}>{coin.name}</Link>{' '}
            </li>
          ))}{' '}
        </ul>
      )}{' '}
    </>
  );
}
```

### React Queryë¥¼ ì‚¬ìš©í•´ì„œ êµ¬í˜„í•˜ëŠ” ë°©ë²•

1. react query íŒ¨í‚¤ì§€ë¥¼ ë‹¤ìš´ë°›ì•„ì•¼í•©ë‹ˆë‹¤.

```text
npm i -DÂ @tanstack/react-query-devtools
```

1. QueryClientë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

```jsx
const queryClient = new QueryClient();
```

1. Providerë¡œ react-queryë¥¼ ì‚¬ìš©í•  ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ì£¼ê³ , client ì†ì„±ì— queryClientë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.

```jsx
<QueryClientProvider client={queryClient}>
  {' '}
  <App />
</QueryClientProvider>
```

1. react-queryë¥¼ ì‚¬ìš©í•  Coins ì»´í¬ë„ŒíŠ¸ì—ì„œ useQueryë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

useQueryëŠ” ë‘ ê°œì˜ argumentsë¥¼ ë°›ìŠµë‹ˆë‹¤.

- queryKey(ê³ ìœ  ì‹ë³„ì)
- fetcher function

ì €ëŠ” queryKeyëŠ” â€œallCoinsâ€ë¼ê³  ì •í•´ì£¼ê³  fetcher functionì€ useEffect ì•ˆì— ìˆë˜ ì½”ë“œë¥¼ ì™¸ë¶€ íŒŒì¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```jsx
// api.jsexport async function fetchCoins() {  const response = await fetch('https://api.coinpaprika.com/v1/coins');  const json = await response.json();  return json;}
```

```jsx
import { useQuery } from 'react-query';
import { fetchCoins } from '../api';
export default function Coins() {
  useQuery('allCoins', fetchCoins);
}
```

useQuery(â€˜allCoinsâ€™, fetchCoins)ê°€ ë¬´ì—‡ì„ ë°˜í™˜í•˜ëŠ”ê±¸ê¹Œìš”?ğŸ¤”
![useQuery](/images/content/learning-react-query-with-practice/3.png)

ì²˜ìŒ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ë©´ statusê°€ loadingì¸ ê°ì²´ë¥¼ ë°˜í™˜í•˜ê³ , ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ í›„ì—ëŠ” statusê°€ successì¸ ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

![](/images/content/learning-react-query-with-practice/4.png)

ê°ì²´ë¥¼ ë³´ë©´ isLoadingì— ëŒ€í•œ ì •ë³´ë„ ìˆê³ , dataì— ëŒ€í•œ ì •ë³´ë„ ìˆìœ¼ë‹ˆ êµ¬ì¡°ë¶„í•´í• ë‹¹ì„ í†µí•´ ê°€ì ¸ì˜¤ë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

```jsx
import { useQuery } from 'react-query';
import { fetchCoins } from '../api';
export default function Coins() {
  const { isLoading, data } = useQuery('allCoins', fetchCoins);
  return (
    <>
      {' '}
      <h1>Coins</h1> {isLoading ? (
        <h1>Loading...</h1>
      ) : (
        <ul>
          {' '}
          {data.slice(0, 100).map((coin) => (
            <li key={coin.id}>
              {' '}
              <Link to={`/${coin.id}`}>{coin.name}</Link>{' '}
            </li>
          ))}{' '}
        </ul>
      )}{' '}
    </>
  );
}
```

react-queryë¥¼ ì‚¬ìš©í•˜ë©´ ë¶ˆëŸ¬ì™”ë˜ ë°ì´í„°ëŠ” ìºì‹œì— ì €ì¥í•´ë†“ê¸° ë•Œë¬¸ì— ë‹¤ì‹œ â€œ/â€œë¡œ ëŒì•„ì™”ì„ ë•Œ ìƒˆë¡œê³ ì¹¨ì„ í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.

## ReactQueryDevtools

: ì„œë²„ì—ì„œ ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë“¤ì„ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ë°©ë²•
ReactQueryDevtoolsë¡œ ìºì‹œì— ìˆëŠ” queryë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ì„  ReactQueryDevToolsë¥¼ import í•©ë‹ˆë‹¤. ê·¸ í›„ initialIsOpen ì†ì„± ê°’ì— trueë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.

```jsx
import Router from './Router';
import { ReactQueryDevtools } from 'react-query/devtools';
export default function App() {
  return (
    <>
      {' '}
      <Router /> <ReactQueryDevtools initialIsOpen={true} />{' '}
    </>
  );
}
```

![](/images/content/learning-react-query-with-practice/5.png)

ë¸Œë¼ìš°ì €ë¥¼ í™•ì¸í•´ë³´ë©´ ìºì‹œì— ì–´ë–¤ queryë“¤ì´ ì €ì¥ë˜ì–´ìˆëŠ”ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ :)

## Reference

- https://velog.io/@jkl1545/React-Query
- Tanstack Query
- kyounghwan01.github.io/blog/React
