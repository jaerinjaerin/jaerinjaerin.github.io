---
title: 'Reduxë¥¼ ì´ìš©í•œ ì‡¼í•‘ëª° ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸° - íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ğŸ”«'
date: 2023-04-26
tags: ['Retrospective']
thumbnail: /thumbnails/default.jpg
---

import { Callout } from 'fumadocs-ui/components/callout';

ì´ë²ˆ ì£¼ì—ëŠ” ë¦¬ë•ìŠ¤ì— ëŒ€í•´ì„œ ê³µë¶€í•˜ê³  ë¦¬ë•ìŠ¤ë¥¼ í™œìš©í•´ì„œ ì´ì „ì— ë§Œë“¤ì—ˆë˜ ì‡¼í•‘ëª° ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¦¬íŒ©í† ë§í•˜ëŠ” ê³¼ì œë¥¼ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.
ìš°ì„  ì´ ê³¼ì œë¥¼ í•˜ë©´ì„œ ëŠê¼ˆë˜ ê±´ ë¦¬ë•ìŠ¤â€¦ ì´ë†ˆ ë­”ë°â€¦ ì…ë‹ˆë‹¤. ë„ˆë¬´ ì–´ë µë”êµ°ìš”. ê·¸ë˜ë„ ì–´ë–»ê²Œë“  ì´í•´í•˜ê³  ê³¼ì œë¥¼ í•˜ë©´ì„œ ì„±ì¥í•´ì•¼í•˜ëŠ” ê²ƒì´ ì½”ë“œìŠ¤í…Œì´ì¸  ìˆ˜ê°•ìƒì˜ ìˆ™ëª… ì•„ë‹ˆê² ìŠµë‹ˆê¹Œ.

ê³¼ì œë¥¼ í•˜ë©´ì„œ ë§ë‹¥ëœ¨ë ¸ë˜ ì˜¤ë¥˜ë¥¼ ë‚¨ê²¨ë†“ì§€ ì•Šìœ¼ë©´ ì´í›„ì— ì–´ë–»ê²Œ ë¬¸ì œë¥¼ í•´ê²°í–ˆëŠ”ì§€ ë¶„ëª… ê¹Œë¨¹ì„ ê²ƒ ê°™ì•„ì„œ ê¸°ë¡í•˜ë ¤ê³  í•©ë‹ˆë‹¤.

## 1ï¸âƒ£ ì‚­ì œë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ Reducer í•¨ìˆ˜ ì½”ë“œì—ì„œì˜ ì˜¤ë¥˜

ì‚­ì œë²„íŠ¼ì„ ëˆ„ë¥´ë©´ `dispatch(removeFromCart(itemId))`ê°€ ì‹¤í–‰ë˜ê³  dispatch ê°ì²´ëŠ” Reducer í•¨ìˆ˜ë¡œ ë°˜í™˜í•œ Actionê°ì²´ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.
Action ê°ì²´ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```jsx
{  type: REMOVE_FROM_CART,  payload: { itemId },}
```

Reducer í•¨ìˆ˜ëŠ” action.typeì— ë”°ë¼ stateë¥¼ ë³€ê²½í•œ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.state.cartItemsì—ì„œ ì¸ìë¡œ ë°›ì€ `action.payload.itemIdâ€™ë§Œ ì œê±°í•œ í›„ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë°˜í™˜í•˜ë©´ ë˜ê² ë‹¤ë¼ëŠ” ìƒê°ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
**ì˜¤ë¥˜ ì½”ë“œ**

```jsx
case REMOVE_FROM_CART:  const ID = action.payload.itemId;  return Object.assign({}, state, {    cartItems: state.cartItems.filter((item) => item.itemId !== ID);  })
```

cartItemsì— ë°”ë¡œ ë„£ìœ¼ë©´ ë°˜ì˜ì„ ëª»í•˜ëŠ”ê±´ê°€â€¦? filter í•¨ìˆ˜ëŠ” ìƒˆë¡œìš´ ë°°ì—´ì„ ë°˜í™˜í•˜ê³  ê·¸ ë°°ì—´ì„ cartItemsì— ê°’ìœ¼ë¡œ ë„£ì–´ì£¼ê² ë‹¤ëŠ”ê±´ë° ì™œ ë™ì‘ì´ ì•ˆë˜ëŠ”ê±¸ê¹Œ?ğŸ¤”

**ì •ìƒë™ì‘ ì½”ë“œ**

```jsx
case REMOVE_FROM_CART:  const ID = action.payload.itemId;  const cartItems = state.cartItems.filter((item) => item.itemId !== ID);  return Object.assign({}, state, {    cartItems: cartItems,  });
```

ì—¬ê¸°ì„œ ì˜ë¬¸ì ì´ ë“  ê±´ ìœ„ ì½”ë“œëŠ” ë™ì‘í•˜ì§€ ì•Šê³  ì•„ë˜ ì½”ë“œëŠ” ì •ìƒì ìœ¼ë¡œ ë™ì‘í•œë‹¤ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.
ì´ìœ ë¥¼ ì°¾ê¸° ìœ„í•´ì„œ ì œëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•Šì•˜ë˜ ì½”ë“œë¥¼ ì‚´ë ¤ì„œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œì¼œë³´ë‹ˆâ€¦. ì •ìƒì ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤â€¦

![](https://pbs.twimg.com/media/DgNb9OZUEAAmONL?format=jpg&name=small)

ì˜¤ë¥˜ ì½”ë“œë¥¼ ì œëŒ€ë¡œ ê¸°ë¡í•´ë†“ì§€ ì•Šì•„ ì •í™•íˆ ì–´ë””ì„œ ì˜¤ë¥˜ê°€ ë‚¬ëŠ”ì§€ ì°¾ì§€ ëª»í•œ ë‚˜â€¦ ì˜¤ë¥˜ì™€ ì›ì¸ì„ ì°¾ê¸° ìœ„í•´ì„  ì½”ë“œì™€ ì˜¤ë¥˜ë©”ì„¸ì§€, ê·¸ë¦¬ê³  ì–´ë–¤ í™˜ê²½ì´ì—ˆëŠ”ì§€ê¹Œì§€ ê¸°ë¡ì„ í•´ë†”ì•¼í•œë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤.

## 2ï¸âƒ£ ìƒí’ˆì„ ì¶”ê°€í•œ í›„ â€˜/shoppingcartâ€™ í˜ì´ì§€ë¡œ ë„˜ì–´ê°”ì„ ë•Œ ë Œë”ë§ë˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜

ì¥ë°”êµ¬ë‹ˆì— ìƒí’ˆì„ ë‹´ê³  ì¥ë°”êµ¬ë‹ˆ í˜ì´ì§€ë¡œ ë„˜ì–´ê°”ì„ ë•Œ ë‹´ì€ ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆë“¤ì´ ë Œë”ë§ë˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

![](/images/content/shopping-app-with-redux-troubleshooting/1.gif)

stateì— ê°’ìœ¼ë¡œ ë¬´ì—‡ì´ ë“¤ì–´ì˜¤ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì½˜ì†”ì„ ì¶œë ¥í•´ë³´ë‹ˆ

```jsx
export default function ShoppingCart() {  const state = useSelector((state) => state.itemReducer);  console.log('shoppingcartê°€ ë Œë”ë§ë˜ê³  ë‚˜ì„œì˜ state', state);
```

![](/images/content/shopping-app-with-redux-troubleshooting/2.png)

cartItems ë°°ì—´ì— ì²˜ìŒ ë“¤ì–´ê°€ìˆë˜ ìƒí’ˆ 3ê°œë¥¼ ì œì™¸í•˜ê³  1ê°œì˜ ìƒí’ˆì„ ì˜ ì¶”ê°€í•´ì„œ ë„£ì€ ê²ƒ ê°™ì§€ë§Œ..?

![](/images/content/shopping-app-with-redux-troubleshooting/3.png)

ë§ˆì§€ë§‰ì— ë„£ì€ ê°ì²´ì˜ ìƒíƒœê°€ ì´ìƒí•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ìš°ì„  ê°ì²´ë¥¼ ë§Œë“œëŠ” ê³³ë¶€í„° ì°¾ì•„ì„œ í•˜ë‚˜ì”© í™•ì¸ì„ í–ˆìŠµë‹ˆë‹¤.

```jsx
export const addToCart = (itemId) => {
  return { type: ADD_TO_CART, payload: { itemId, quantity: 1 } };
};
```

addToCart í•¨ìˆ˜ì—ì„œëŠ” ë¬¸ì œê°€ ì—†ìœ¼ë‹ˆ, dispatch í•¨ìˆ˜ê°€ Reducer í•¨ìˆ˜ì—ê²Œ Action ê°ì²´ë¥¼ ì–´ë–»ê²Œ ë³´ë‚´ëŠ”ì§€ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

```jsx
const handleClick = (item) => {  if (!cartItems.map((el) => el.itemId).includes(item.id)) {    //TODO: dispatch í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì•„ì´í…œ ì¶”ê°€ì— ëŒ€í•œ ì•¡ì…˜ì„ ì „ë‹¬í•˜ì„¸ìš”.    dispatch(addToCart());    dispatch(notify(`ì¥ë°”êµ¬ë‹ˆì— ${item.name}ì´(ê°€) ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`));  } else {    dispatch(notify('ì´ë¯¸ ì¶”ê°€ëœ ìƒí’ˆì…ë‹ˆë‹¤.'));  }};
```

ì•—..addToCartì— ì•„ë¬´ê²ƒë„ ë„£ì–´ì£¼ì§€ ì•Šì•˜êµ°ìš”..
addToCart action creatorëŠ” itemIdë¥¼ ë°›ì•„ì„œ ê°ì²´ë¥¼ ë§Œë“¤ê¸° ë•Œë¬¸ì— addToCart í•¨ìˆ˜ì—ëŠ” item.idë¥¼ ë„£ì–´ì¤Œìœ¼ë¡œì¨ ì˜¤ë¥˜ë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

## 3ï¸âƒ£ ì—ëŸ¬ëŠ” ì•„ë‹ˆì§€ë§Œ Reducer í•¨ìˆ˜ ì½”ë“œì— ëŒ€í•œ ê³ ë¯¼

ê³ ë¯¼ì„ í•˜ê²Œ ëœ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```jsx
case SET_QUANTITY:  let idx = state.cartItems.findIndex(    (el) => el.itemId === action.payload.itemId  );  state.cartItems[idx].quantity = action.payload.quantity;  return Object.assign({}, state, { cartItems: [...state.cartItems] });default:  return state;
```

ìˆ˜ëŸ‰ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œë§ˆë‹¤ ìˆ˜ëŸ‰ì„ ë³€ê²½í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.ì½”ë“œëŠ” ì •ìƒì ìœ¼ë¡œ ë™ì‘ì„ í•©ë‹ˆë‹¤ë§Œ, Reducer í•¨ìˆ˜ì˜ ê¸°ë³¸ì  ì›ì¹™ì„ ë²—ì–´ë‚¬ë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.

<Callout>
  ë°”ë¡œ Reducerì˜ Immutability(ë¶ˆë³€ì„±)ì…ë‹ˆë‹¤. Reduxì˜ state ì—…ë°ì´íŠ¸ëŠ”
  immutableí•œ ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì¸ë°ìš”. Reduxì˜ ì¥ì  ì¤‘ í•˜ë‚˜ì¸ ë³€ê²½ëœ
  stateë¥¼ ë¡œê·¸ë¡œ ë‚¨ê¸°ê¸° ìœ„í•´ì„œ ê¼­ í•„ìš”í•œ ì‘ì—…ì…ë‹ˆë‹¤.
</Callout>

í•˜ì§€ë§Œ ì œê°€ ì‘ì„±í•œ ì½”ë“œëŠ” state.cartItemsì˜ ìˆ˜ëŸ‰ì„ ì§ì ‘ì ìœ¼ë¡œ ë³€ê²½ì‹œí‚¤ê³  ë³€ê²½ëœ stateë¥¼ ìƒˆë¡œìš´ ê°ì²´ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤. ìƒˆë¡œìš´ ê°ì²´ë¡œ ë°˜í™˜ì€ í–ˆì§€ë§Œ stateë¥¼ ì§ì ‘ ê±´ë“¤ì˜€ê¸° ë•Œë¬¸ì— immutableí•˜ì§€ ëª»í•œ í•¨ìˆ˜ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.

immutable í•˜ê²Œ ì‘ì„±í•˜ê¸° ìœ„í•´ì„  cartItems[idx]ë¥¼ ê¸°ì¤€ìœ¼ë¡œ sliceë¥¼ í•œ í›„ ìƒˆë¡œìš´ ë°°ì—´ì— ë‹´ëŠ” ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.

````jsx
case SET_QUANTITY:  let idx = state.cartItems.findIndex(el => el.itemId === action.payload.itemId)  return Object.assign({}, state, {    cartItems: [...state.cartItems.slice(0, idx), action.payload,    ...state.cartItems.slice(idx + 1)]  });```
````

## Review

íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ì´ë¼ê³  í•˜ê¸°ì—” ë„ˆë¬´ ê±°ì°½í•œ ê²ƒ ê°™ê³  ì˜¤ë¥˜ í•´ê²° ì¼ì§€ê°€ ë”± ì•Œë§ëŠ” ë‹¨ì–´ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤.ê¸°ë¡ì„ í•˜ë©´ì„œ ë‚´ê°€ ì–´ë””ì„œ ì˜ ëª»í–ˆê³ , ì–´ë–»ê²Œ í•´ê²°í–ˆëŠ”ì§€ ë‹¤ì‹œ í•œ ë²ˆ ìƒˆê²¨ë„£ì„ ìˆ˜ ìˆëŠ” ì‹œê°„ì´ ëœ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì˜¤ë¥˜ë¥¼ í•´ê²°í•˜ëŠ” ê³¼ì •ì„ ê³„ì†í•´ì„œ ë‚¨ê²¨ë†“ìœ¼ë©´ ìŠ¤ìŠ¤ë¡œì—ê²Œ êµ‰ì¥íˆ ë„ì›€ì´ ë  ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤. :)
